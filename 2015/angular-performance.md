# 优化Angular应用的性能
  by 民工精髓V
  ________________________________
  （观赏本 slide 请使用 Chrome 45+ 等支持 ES6、Fetch API 等新特性的浏览器）

## WHO AM I
  name: 徐飞（民工叔）
  weibo: @民工精髓V
  github: @xufei
  zhihu： 徐飞 /*三流程序员，二流架构师*/
  AngularJS等前端组件化框架，组件化与快速开发

## 2015年被吐槽最多的主流前端组件化框架

Angular

理由？
  模块机制
  性能

## 为什么大家觉得Angular性能不好？

脏检测机制

## MVVM框架的性能取决于哪些因素？

  监控的个数
  数据变更检测与绑定的方式
  索引的性能
  数据的大小
  数据的结构

## 监控的个数

什么样的东西会产生监控？

界面上绑定的变量或者方法
手动观测的表达式
  $watch
  $watchCollection
  $watchGroup
  
减少不必要的监控，单次绑定

## 降低数据比对的开销

数据的更新方式：
  推，setter中给关联数据赋值
  拉，getter中动态获取数据
  
拉模式的开发负担低
特殊业务场景下适当使用推模式

Angular 1.x检测变更的方式是脏检测

可以用一些技巧使脏检测快速返回结果

比如，Angular如何知道一个数组变了？
  比较引用
  比较长度
  逐个比对元素
  
immutable？

immutable可以让数据比对立即得到结果，跳过细节比较
但是弊端是需要每次把每次返回结果转化为pojo

使用js原生的一些方法可以加速比对结果：
  filter
  map
  reduce
  
## 提升索引的性能

ng-repeat是如何跟踪数据的？

隐式索引

显式索引
  显式指定数据的唯一索引
  track by $index
  track by id

## 降低数据的大小

数据的大小是由业务决定的，怎么能减少？

但是，一屏幕可见的数据是很少的

所以我们可以分页

虚拟列表
  内存保持全量数据
  根据滚动条位置，计算出对应位置的一小撮数据并渲染

## 数据的扁平化

MVVM框架不适合处理树状数据
树状数据本身就是不太适合观测的

但业务中有很多使用树的场景
  树控件
  拓扑图
  MindMap
  
为了这些东西的方面，一定需要存在树状数据

但是，我们可以保留原始的列表型数据

树状数据用于业务操作
扁平数据用于视图绑定

MVVM中，VM的一个重要职责是？

将Model数据转换为适合视图展示的格式

## 小结

Angular这类框架的重要意义：
  牺牲一部分性能
  大幅提升开发效率
  
不必刻意优化UI层的性能
只对特殊场景优化

## 谢谢

鸣谢：@hax 的幻灯片模板
